---
title: "Rethinking Tornado Casualy Rates"
author: "Tyler Fricker"
date: "8/5/2019"
output: html_document
---

The United States experiences around 1000 tornadoes a year, resulting in nearly 1200 casualties (injuries and fatalities). While previous research has focused on analyzing and mapping the patterns of human vulnerability related to tornado casualties, little has been done to estimate the rate of tornado casualties at either the individual---per person---or household---number of houses---level.

The goal of this work is to create a baseline rate of tornado casualties given an estimate of the number of people or the number of housing units impacted by a tornado. 

Load packages.
```{r}
library(ggplot2)
library(dplyr)
library(lubridate)
library(sf)
```

Begin by reading in tornado-level estimates of socioeconomic and demographic variables.
```{r}
unzip("SocialCorrelatesNew.zip")
TornSC.sf <- st_read(dsn = "SocialCorrelatesNew", 
                    layer = "SocialCorrelatesNew", 
                    stringsAsFactors = FALSE) %>%
  mutate(Date = as.Date(date),
         hr = hour(DateTim))
```

Estimate the exposure and casualty rate by year
```{r}
df <- data.frame(TornSC.sf) %>%
  group_by(Year) %>%
  summarize(nT = n(), 
         nCas = sum(cas),
         Exposure = sum(TotalPp))

ggplot(df, aes(x = Year, y = nCas)) +
  geom_point() + geom_smooth(method = "lm")

ggplot(df, aes(x = Year, y = nCas/nT)) +
  geom_point() + geom_smooth(method = "lm")

ggplot(df, aes(x = Year, y = nCas/Exposure)) +
  geom_point() + geom_smooth(method = "lm")

ggplot(df, aes(x = Year, y = Exposure)) +
  geom_point() + geom_smooth(method = "lm")

ggplot(df, aes(x = Year, y = Exposure/nT)) +
  geom_point() + geom_smooth(method = "lm")
```

```{r}
formula1 <- (nCas/Exposure) ~ Year
fit <- lm(formula1, data = df)
summary(fit)
```




